/*! boxDialog 1.0 @author:虾兵 @Blog:http://ddbing.com/ 一款想到即能做到的通用弹窗组件-2015-12-19 */
!function(a,b,c){"use strict";function d(a){return function(b){return{}.toString.call(b)==="[object "+a+"]"}}function e(){var a,b=v.length;return a=1==b?v[0]:v[b-1]}function f(a){var b,c=a,d=v.length;z(c)&&d&&(c=v[d-1]),b=m("#"+G.wrap+c).children().children("."+G.close),b.length?b.trigger("click"):(m("#"+G.wrap+c).remove(),m("#"+G.wrap+(c-1)).length&&m("#"+G.wrap+(c-1)).remove())}function g(){v.length&&(m.each(v,function(a){f(a)}),v.length=0)}function h(a,b,c,d){switch(d=y(d)?d:2,a=x(a)?a:F.title,b=x(b)?b:F.content,c){case"success":c="success";break;case"failure":c="failure";break;case"warning":c="warning";break;case"question":c="question";break;default:c=null}k({title:a,content:b,icon:c,time:d,ok:!1,cancel:!1})}function i(a,b,c){c=c?c:"198px",x(a)&&k({cancel:!1,content:a,okCallback:b,size:[c]})}function j(a){if(C(a)&&!a){var b=m(".box-dialog-loading").attr("data-index");return void(b&&f(b))}k({title:!1,ok:!1,cancel:!1,content:!1,shade:!1,varTemp:"loading",size:["24px","24px"]})}function k(a){var b;return b=new D(a)}var l=l||{},m=a.jQuery,n="1.0",o=null,p=m(a),q=m(b),r=m(b.body),s=b.documentElement,t=0,u=!1,v=[],w=d("Function"),x=d("String"),y=d("Number"),z=d("Undefined"),A=d("Array"),B=d("Object"),C=d("Boolean"),D=function(a){var b=this;(x(a)||1===a.nodeType)&&(a={content:a}),b.index=++t,b.Doms=G,b.opts=m.extend({},F,o,a),b.init()};D.prototype={constructor:D,version:n,init:function(){var a=this,b=a.opts,c=a.index,d=b.content;return a.winW=p.width(),a.winH=p.height(),a.getDoms().setPosition().topIndex().addEvent(),w(b.initCallback)&&b.initCallback.call(a,c),b.time&&y(b.time)&&a.time(),d&&1===d.nodeType&&a.varDom(c,d),b.esc||a.removeEvent(c,"esc"),b.content&&b.content.iframe&&!y(a.initSize().h)&&a.setIframe(),a},getDoms:function(){var a,b,c,d,e,f,g=this,h=g.opts,i=g.Doms,j=g.index,k=o?o:"",l="",n="",p=h.icon,q=g.content(),s=g.getBtns(),t=s.length,u=u||{},w=h.varTemp,z=g.initSize(),A=g.isIframe,B=y(z.w)?z.w+"px":z.w,C=y(z.h)?z.h+"px":z.h;switch(n=p&&function(){return'<em class="boxdialog-icon '+h.icon+'"></em>'}(),c=A?"":"padding:"+h.padding+";",e='style="'+c+(C?"height:"+C+";":"")+(!x(q)||A||p?"":"text-align:center;")+'"',f='style="width:'+B+';"',h.title&&(b=function(){var a="";return a='<div class="boxdialog-title"'+(h.drag?'style="cursor:move"':"")+">"+(x(h.title)?h.title:"")+"</div>",h.closeBtn?a+='<div class="boxdialog-close-box"><a href="javascript:;" class="boxdialog-close">×</a></div>':a}()),t>0&&(a=function(){var a="";return m.each(s,function(b,c){var d=c.text,e=!1;u[d]=u[d]||{},u[d].callback=c.callback,h.okText===d&&(e=i.btnActive),a+='<button class="boxbtn'+(e?" "+e:"")+(c.className?" "+c.className:"")+'"'+(c.disabled?' disabled="'+c.disabled+'"':"")+' data-title="'+c.text+'">'+c.text+"</button>"}),g.btnListens=u,a}()),w){case"loading":d='<img src="'+k+'skins/icons/loading.gif">',l+='<div class="box-dialog box-dialog-loading" id="box-dialog'+j+'" data-index ="'+j+'" '+f+">"+(b?b:"")+'<div class="boxdialog-content" '+e+">"+d+"</div></div>";break;default:l+='<div class="box-dialog'+(h.className?" "+h.className:"")+'" id="box-dialog'+j+'" data-index ="'+j+'" '+f+">"+(b?b:"")+'<div class="boxdialog-content'+(p?" boxdialog-icon-true":"")+'" '+e+">"+(n?n:"")+(q?q:"")+"</div>"+(t?'<div class="boxdialog-btns">'+a+"</div>":"")+"</div>"}return r.append(l),v.push(j),g},content:function(){var a=this,b=a.opts,c=(a.index,a.Doms,b.content);if(!z(c)){if(c&&1===c.nodeType){var d=c.style.display,e=c.previousSibling,f=c.nextSibling,g=c.parentNode;return void(a.eleBack=function(){e&&e.parentNode?e.parentNode.insertBefore(c,e.nextSibling):f&&f.parentNode?f.parentNode.insertBefore(c,f):g&&g.appendChild(c),c.style.display=d})}return B(c)&&c.iframe?(a.isIframe=!0,a.iframe()):c}},iframe:function(){var a,b,c,d,e,f,g=this,h=g.opts,i=g.index,j=g.Doms,k="",l=h.content,m=g.initSize(),n=y(m.h)?m.h:"";return a=l.url,b=l.frameborder?l.frameborder:"no",c=l.border?l.border:0,d=l.scrolling?l.scrolling:"auto",e=l.allowtransparency?l.allowtransparency:"yes",f=l.className?'class="'+l.className+'"':"",k='<iframe id="'+j.iframe+i+'" name="'+j.iframe+i+'"'+(n?' height="'+n+'"':"")+' class="'+j.iframe+'" src="'+a+'" frameborder="'+b+'" border="'+c+'" scrolling="'+d+'" allowtransparency="'+e+'"'+f+"></iframe>"},setIframe:function(){var a=this,b=(a.opts,a.index),c=a.Doms,d=(m("#"+c.iframe+b),m("#"+c.wrap+b)),e=d.children("."+c.title),f=d.children("."+c.btns);e.outerHeight(),f.outerHeight();return m("#"+c.iframe+b).on("load",function(){var b=m(this),c=b.contents().find("body").outerHeight();b.height(c),a.setPosition()}),a},varDom:function(a,b){var c=this,d=(c.opts,a||c.index),e=c.Doms,f=m("#"+e.wrap+d),g=f.children("."+e.content);return b.style.display="block",g[0].appendChild(b),c},getBtns:function(a){var b=this,c=b.opts,d=(a||b.index,c.ok),e=c.cancel,f=A(c.varBtns)?c.varBtns:[];return d&&f.push({text:c.okText,callback:c.okCallback}),e&&f.push({text:c.cancelText,callback:c.cancelCallback}),b.btns=f,f},initSize:function(){var a,b,c=this,d=c.opts,e=d.size,f=c.winW,g=c.winH,h=m.trim(d.padding).split(" ");c.toNumber(h[0]),c.toNumber(h[1]);return a=e[0],b=e[1],"auto"!=m.trim(a)&&(a=c.toNumber(e[0],f)),"auto"!=m.trim(b)&&(b=c.toNumber(e[1],g)),{w:a,h:b}},setSize:function(a,b){var c=this,d=c.opts,e=c.index,f=c.Doms,g=m("#"+f.wrap+e),h=g.children("."+f.content),i=g.children("."+f.title),j=g.children("."+f.btns),k=a||d.size[0],l=b||d.size[1],n=i.outerHeight(),o=j.outerHeight(),p=c.winW,q=c.winH;return k&&(k.indexOf("px")>-1?h.css("width",k):(k=c.toNumber(k,p),h.width(k)),g.width(h.outerWidth())),l&&(l.indexOf("px")>-1?h.css("height",l):(l=c.toNumber(k,q),h.height(l)),g.height(h.outerHeight()+n+o)),c},setPosition:function(){var a,b,c,d,e,f=this,g=f.opts,h=f.index,i=f.Doms,j=m("#"+i.wrap+h),k=(j.children("."+i.content),j[0].style),l=f.winW,n=f.winH,o=j.outerWidth(),p=j.outerHeight(),q=g.position;return a=g.fixed?"fixed":"absolute",k.position=a,B(q)&&(b=q.left,c=q.top,d=q.right,e=q.bottom),b&&!d?(b=f.toNumber(b),k.left=b+"px"):d&&!b?(d=f.toNumber(d),k.right=d+"px"):k.left=parseInt((l-o)/2)+"px",c&&!e?(c=f.toNumber(c),k.top=c+"px"):e&&!c?(e=f.toNumber(e),k.bottom=e+"px"):k.top=parseInt((n-p)/2,10)+"px",f.left=k.left,f.top=k.top,f},toNumber:function(a,b){var c=/^\d+%$/;if(a)return y(b)&&c.test(a)&&(a=b*a.split("%")[0]/100),a=parseInt(a,10)},time:function(a){var b=this,c=b.opts,a=a||c.time;return a&&y(a)&&setTimeout(function(){b.close()},1e3*a),b},topIndex:function(a){var b=this,c=b.opts,d=a||b.index,e=b.Doms,f=c.zIndex,g=e.wrap,h=e.topActive,i=c.shade;return f+=d,u?(m("."+e.wrap).removeClass(h),m("#"+g+d).css("zIndex",f).addClass(h)):(m("#"+g+d).css("zIndex",f).addClass(h),u=!0),i&&b.shade().css("zIndex",f-1),b},shade:function(){var a,b=this,c=b.opts,d=b.index,e=b.Doms,f=c.shade,g=f.background,h=f.opacity,i=f.duration;m("#"+e.wrap+d);return a=m("<div></div>"),a.attr({id:"box-dialog-shade"+d,"data-index":d}).addClass(e.shade).css({background:g}),i?a.css({opacity:0}).animate({opacity:h},i):a.css({opacity:h}),r.append(a),a},addEvent:function(){var a=this,b=a.opts,c=a.index,d=a.Doms,e=m("#"+d.wrap+c),f=e.children().children("."+d.close),g=e.children("."+d.btns);return f.on("click",function(){return a.click(),!1}),g.on("click",function(b){var c,d=(a.btns,b.target||b.srcElement);return d.disabled?!1:(c=m(d).attr("data-title"),void(c&&a.click(c)))}),p.on("resize",function(){a.reset()}),b.drag&&a.drag(c),a},removeEvent:function(a,b){var c=this;switch(b){case"esc":q.off("keydown");break;default:v.length<1&&(p.off("resize"),q.off("keydown"))}return c},click:function(a){var b,c=this,d=c.btns,e=c.btnListens;return a?(x(a)&&d.length>0&&(b=e[a]&&e[a].callback),b||c.close(),w(b)&&b.call(c,t)!==!1?c.close():c):void c.close()},close:function(a){var b=this,c=b.opts,d=a||b.index,e=b.Doms,f=c.closeCallback,g=m("#"+e.wrap+d),h=m("#"+e.shade+d),i=e.topActive,j=c.shade.duration,k=v.length;return b.eleBack&&b.eleBack(),g.remove(),h&&h.animate({opacity:0},j,function(){m(this).remove()}),k>1?(m.each(v,function(a,b){b==d&&v.splice(a,1)}),m("#"+e.wrap+v[k-1]).addClass(i)):(v.length=0,u=!1),w(f)&&f.call(b,d),b},reset:function(a){var b,c,d,e,f,g=this,h=(g.opts,a||g.index),i=g.Doms,j=m("#"+i.wrap+h),k=g.winW,l=g.winH,n=g.left,o=g.top,q=p.width(),r=p.height();j[0]&&(b=j[0].style,f&&clearTimeout(f),f=setTimeout(function(){e()},100),e=function(){c=n.split("px")[0]-parseInt((k-q)/2),d=o.split("px")[0]-parseInt((l-r)/2),0>c?b.left=0:b.left=c+"px",0>d?b.top=0:b.top=d+"px"})},drag:function(a){var b=this,c=(b.opts,a||b.index),d=b.Doms,e=m("#"+d.wrap+c),f=e.children("."+d.title),g=q[0],h=e[0],i=h.style;return f[0].onmousedown=function(a){var a=a||window.event,b=0,c=0;e.fadeTo("fast",.6),b=a.clientX-h.offsetLeft,c=a.clientY-h.offsetTop,g.onmousemove=function(a){var d,e,f,g,a=a||window.event;d=a.clientX-b,e=a.clientY-c,f=s.clientWidth-h.offsetWidth,g=s.clientHeight-h.offsetHeight,d=d>0?d:0,d=d>f?f:d,e=e>0?e:0,e=e>g?g:e,i.left=d+"px",i.top=e+"px",a.preventDefault()},g.onmouseup=function(){e.fadeTo("fast",1),g.onmousemove=null,g.onmouseup=null,a.preventDefault()},a.preventDefault()},b}};var E,F,G={wrap:"box-dialog",title:"boxdialog-title",close:"boxdialog-close",content:"boxdialog-content",btns:"boxdialog-btns",icon:"boxdialog-icon",shade:"box-dialog-shade",topActive:"box-dialog-active",btnActive:"boxbtn-active",iframe:"boxdialog-iframe"};E=function(a){return B(a)?o=a:void 0},F={title:"消息",content:"欢迎使用boxDialog!",ok:!0,cancel:!0,okText:"确定",cancelText:"取消",size:["auto","auto"],padding:"20px",icon:null,time:null,shade:{background:"#000",opacity:.8,duration:200},fixed:!0,zIndex:2010,drag:!1,esc:!0,position:null,closeBtn:!0,varBtns:null,className:null,initCallback:null,okCallback:null,cancelCallback:null,closeCallback:null},q.on("keydown",function(a){var b,a=a||p.event,c=!0,d=v.length;d&&c&&27==a.keyCode&&(b=e(),f(b),c=!1)}),"function"==typeof define&&define(function(){return l}),m.boxDialog=m.fn.boxDialog=function(a){k(a)},l={open:k,config:E,close:f,closeAll:g,msg:h,alert:i,loading:j},window.boxDialog=l}(this,document);