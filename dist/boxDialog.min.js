/*! boxDialog 1.0 @author:虾兵 @Blog:http://ddbing.com/ 一款想到即能做到的通用弹窗组件-2015-12-20 */
!function(a,b){"function"==typeof define?define(function(){return b(a)}):b(a)}("undefined"!=typeof window?window:this,function(a){function b(a){return function(b){return{}.toString.call(b)==="[object "+a+"]"}}function c(){var a,b=t.length;return a=1==b?t[0]:t[b-1]}function d(a){var b,c=a,d=t.length;x(c)&&d&&(c=t[d-1]),b=k("#"+E.wrap+c).children().children("."+E.close),b.length?b.trigger("click"):(k("#"+E.wrap+c).remove(),k("#"+E.wrap+(c-1)).length&&k("#"+E.wrap+(c-1)).remove())}function e(){t.length&&(k.each(t,function(a){d(a)}),t.length=0)}function f(a,b,c,d){switch(d=w(d)?d:2,a=v(a)?a:D.title,b=v(b)?b:D.content,c){case"success":c="success";break;case"failure":c="failure";break;case"warning":c="warning";break;case"question":c="question";break;default:c=null}i({title:a,content:b,icon:c,time:d,ok:!1,cancel:!1})}function g(a,b,c){c=c?c:"198px",a=v(a)?a:D.content,b=u(b)?b:D.okCallback,v(a)&&i({cancel:!1,content:a,okCallback:b,size:[c]})}function h(a){if(A(a)&&!a){var b=k(".box-dialog-loading").attr("data-index");return void(b&&d(b))}i({title:!1,ok:!1,cancel:!1,content:!1,shade:!1,varTemp:"loading",size:["24px","24px"]})}function i(a){var b;return b=new B(a)}var j=j||{},k=a.jQuery,l="1.0",m=null,n=k(a),o=k(document),p=k(document.body),q=document.documentElement,r=0,s=!1,t=[],u=b("Function"),v=b("String"),w=b("Number"),x=b("Undefined"),y=b("Array"),z=b("Object"),A=b("Boolean"),B=function(a){var b=this;(v(a)||1===a.nodeType)&&(a={content:a}),b.index=++r,b.Doms=E,b.opts=k.extend({},D,m,a),b.init()};B.prototype={constructor:B,version:l,init:function(){var a=this,b=a.opts,c=a.index,d=b.content;return a.winW=n.width(),a.winH=n.height(),a.getDoms().setPosition().topIndex().addEvent(),u(b.initCallback)&&b.initCallback.call(a,c),b.time&&w(b.time)&&a.time(),d&&1===d.nodeType&&a.varDom(c,d),b.esc||a.removeEvent(c,"esc"),b.content&&b.content.iframe&&!w(a.initSize().h)&&a.setIframe(),a},getDoms:function(){var a,b,c,d,e,f,g=this,h=g.opts,i=g.Doms,j=g.index,l=m?m:"",n="",o="",q=h.icon,r=g.content(),s=g.getBtns(),u=s.length,x=x||{},y=h.varTemp,z=g.initSize(),A=g.isIframe,B=w(z.w)?z.w+"px":z.w,C=w(z.h)?z.h+"px":z.h;switch(o=q&&function(){return'<em class="boxdialog-icon '+h.icon+'"></em>'}(),c=A?"":"padding:"+h.padding+";",e='style="'+c+(C?"height:"+C+";":"")+(!v(r)||A||q?"":"text-align:center;")+'"',f='style="width:'+B+';"',h.title&&(b=function(){var a="";return a='<div class="boxdialog-title"'+(h.drag?'style="cursor:move"':"")+">"+(v(h.title)?h.title:"")+"</div>",h.closeBtn?a+='<div class="boxdialog-close-box"><a href="javascript:;" class="boxdialog-close">×</a></div>':a}()),u>0&&(a=function(){var a="";return k.each(s,function(b,c){var d=c.text,e=!1;x[d]=x[d]||{},x[d].callback=c.callback,h.okText===d&&(e=i.btnActive),a+='<button class="boxbtn'+(e?" "+e:"")+(c.className?" "+c.className:"")+'"'+(c.disabled?' disabled="'+c.disabled+'"':"")+' data-title="'+c.text+'">'+c.text+"</button>"}),g.btnListens=x,a}()),y){case"loading":d='<img src="'+l+'skins/icons/loading.gif">',n+='<div class="box-dialog box-dialog-loading" id="box-dialog'+j+'" data-index ="'+j+'" '+f+">"+(b?b:"")+'<div class="boxdialog-content" '+e+">"+d+"</div></div>";break;default:n+='<div class="box-dialog'+(h.className?" "+h.className:"")+'" id="box-dialog'+j+'" data-index ="'+j+'" '+f+">"+(b?b:"")+'<div class="boxdialog-content'+(q?" boxdialog-icon-true":"")+'" '+e+">"+(o?o:"")+(r?r:"")+"</div>"+(u?'<div class="boxdialog-btns">'+a+"</div>":"")+"</div>"}return p.append(n),t.push(j),g},content:function(){var a=this,b=a.opts,c=(a.index,a.Doms,b.content);if(!x(c)){if(c&&1===c.nodeType){var d=c.style.display,e=c.previousSibling,f=c.nextSibling,g=c.parentNode;return void(a.eleBack=function(){e&&e.parentNode?e.parentNode.insertBefore(c,e.nextSibling):f&&f.parentNode?f.parentNode.insertBefore(c,f):g&&g.appendChild(c),c.style.display=d})}return z(c)&&c.iframe?(a.isIframe=!0,a.iframe()):c}},iframe:function(){var a,b,c,d,e,f,g=this,h=g.opts,i=g.index,j=g.Doms,k="",l=h.content,m=g.initSize(),n=w(m.h)?m.h:"";return a=l.url,b=l.frameborder?l.frameborder:"no",c=l.border?l.border:0,d=l.scrolling?l.scrolling:"auto",e=l.allowtransparency?l.allowtransparency:"yes",f=l.className?'class="'+l.className+'"':"",k='<iframe id="'+j.iframe+i+'" name="'+j.iframe+i+'"'+(n?' height="'+n+'"':"")+' class="'+j.iframe+'" src="'+a+'" frameborder="'+b+'" border="'+c+'" scrolling="'+d+'" allowtransparency="'+e+'"'+f+"></iframe>"},setIframe:function(){var a=this,b=(a.opts,a.index),c=a.Doms,d=(k("#"+c.iframe+b),k("#"+c.wrap+b)),e=d.children("."+c.title),f=d.children("."+c.btns);e.outerHeight(),f.outerHeight();return k("#"+c.iframe+b).on("load",function(){var b=k(this),c=b.contents().find("body").outerHeight();b.height(c),a.setPosition()}),a},varDom:function(a,b){var c=this,d=(c.opts,a||c.index),e=c.Doms,f=k("#"+e.wrap+d),g=f.children("."+e.content);return b.style.display="block",g[0].appendChild(b),c},getBtns:function(a){var b=this,c=b.opts,d=(a||b.index,c.ok),e=c.cancel,f=y(c.varBtns)?c.varBtns:[];return d&&f.push({text:c.okText,callback:c.okCallback}),e&&f.push({text:c.cancelText,callback:c.cancelCallback}),b.btns=f,f},initSize:function(){var a,b,c=this,d=c.opts,e=d.size,f=c.winW,g=c.winH,h=k.trim(d.padding).split(" ");c.toNumber(h[0]),c.toNumber(h[1]);return a=e[0],b=e[1],"auto"!=k.trim(a)&&(a=c.toNumber(e[0],f)),"auto"!=k.trim(b)&&(b=c.toNumber(e[1],g)),{w:a,h:b}},setSize:function(a,b){var c=this,d=c.opts,e=c.index,f=c.Doms,g=k("#"+f.wrap+e),h=g.children("."+f.content),i=g.children("."+f.title),j=g.children("."+f.btns),l=a||d.size[0],m=b||d.size[1],n=i.outerHeight(),o=j.outerHeight(),p=c.winW,q=c.winH;return l&&(l.indexOf("px")>-1?h.css("width",l):(l=c.toNumber(l,p),h.width(l)),g.width(h.outerWidth())),m&&(m.indexOf("px")>-1?h.css("height",m):(m=c.toNumber(l,q),h.height(m)),g.height(h.outerHeight()+n+o)),c},setPosition:function(){var a,b,c,d,e,f=this,g=f.opts,h=f.index,i=f.Doms,j=k("#"+i.wrap+h),l=(j.children("."+i.content),j[0].style),m=f.winW,n=f.winH,o=j.outerWidth(),p=j.outerHeight(),q=g.position;return a=g.fixed?"fixed":"absolute",l.position=a,z(q)&&(b=q.left,c=q.top,d=q.right,e=q.bottom),b&&!d?(b=f.toNumber(b),l.left=b+"px"):d&&!b?(d=f.toNumber(d),l.right=d+"px"):l.left=parseInt((m-o)/2)+"px",c&&!e?(c=f.toNumber(c),l.top=c+"px"):e&&!c?(e=f.toNumber(e),l.bottom=e+"px"):l.top=parseInt((n-p)/2,10)+"px",f.left=l.left,f.top=l.top,f},toNumber:function(a,b){var c=/^\d+%$/;if(a)return w(b)&&c.test(a)&&(a=b*a.split("%")[0]/100),a=parseInt(a,10)},time:function(a){var b=this,c=b.opts,a=a||c.time;return a&&w(a)&&setTimeout(function(){b.close()},1e3*a),b},topIndex:function(a){var b=this,c=b.opts,d=a||b.index,e=b.Doms,f=c.zIndex,g=e.wrap,h=e.topActive,i=c.shade;return f+=d,s?(k("."+e.wrap).removeClass(h),k("#"+g+d).css("zIndex",f).addClass(h)):(k("#"+g+d).css("zIndex",f).addClass(h),s=!0),i&&b.shade().css("zIndex",f-1),b},shade:function(){var a,b=this,c=b.opts,d=b.index,e=b.Doms,f=c.shade,g=f.background,h=f.opacity,i=f.duration;k("#"+e.wrap+d);return a=k("<div></div>"),a.attr({id:"box-dialog-shade"+d,"data-index":d}).addClass(e.shade).css({background:g}),i?a.css({opacity:0}).animate({opacity:h},i):a.css({opacity:h}),p.append(a),a},addEvent:function(){var a=this,b=a.opts,c=a.index,d=a.Doms,e=k("#"+d.wrap+c),f=e.children().children("."+d.close),g=e.children("."+d.btns);return f.on("click",function(){return a.click(),!1}),g.on("click",function(b){var c,d=(a.btns,b.target||b.srcElement);return d.disabled?!1:(c=k(d).attr("data-title"),void(c&&a.click(c)))}),n.on("resize",function(){a.reset()}),b.drag&&a.drag(c),a},removeEvent:function(a,b){var c=this;switch(b){case"esc":o.off("keydown");break;default:t.length<1&&(n.off("resize"),o.off("keydown"))}return c},click:function(a){var b,c=this,d=c.btns,e=c.btnListens;return a?(v(a)&&d.length>0&&(b=e[a]&&e[a].callback),b||c.close(),u(b)&&b.call(c,r)!==!1?c.close():c):void c.close()},close:function(a){var b=this,c=b.opts,d=a||b.index,e=b.Doms,f=c.closeCallback,g=k("#"+e.wrap+d),h=k("#"+e.shade+d),i=e.topActive,j=c.shade.duration,l=t.length;return b.eleBack&&b.eleBack(),g.remove(),h&&h.animate({opacity:0},j,function(){k(this).remove()}),l>1?(k.each(t,function(a,b){b==d&&t.splice(a,1)}),k("#"+e.wrap+t[l-1]).addClass(i)):(t.length=0,s=!1),u(f)&&f.call(b,d),b},reset:function(a){var b,c,d,e,f,g=this,h=(g.opts,a||g.index),i=g.Doms,j=k("#"+i.wrap+h),l=g.winW,m=g.winH,o=g.left,p=g.top,q=n.width(),r=n.height();j[0]&&(b=j[0].style,f&&clearTimeout(f),f=setTimeout(function(){e()},100),e=function(){c=o.split("px")[0]-parseInt((l-q)/2),d=p.split("px")[0]-parseInt((m-r)/2),0>c?b.left=0:b.left=c+"px",0>d?b.top=0:b.top=d+"px"})},drag:function(a){var b=this,c=(b.opts,a||b.index),d=b.Doms,e=k("#"+d.wrap+c),f=e.children("."+d.title),g=o[0],h=e[0],i=h.style;return f[0].onmousedown=function(a){var a=a||window.event,b=0,c=0;e.fadeTo("fast",.6),b=a.clientX-h.offsetLeft,c=a.clientY-h.offsetTop,g.onmousemove=function(a){var d,e,f,g,a=a||window.event;d=a.clientX-b,e=a.clientY-c,f=q.clientWidth-h.offsetWidth,g=q.clientHeight-h.offsetHeight,d=d>0?d:0,d=d>f?f:d,e=e>0?e:0,e=e>g?g:e,i.left=d+"px",i.top=e+"px",a.preventDefault()},g.onmouseup=function(){e.fadeTo("fast",1),g.onmousemove=null,g.onmouseup=null,a.preventDefault()},a.preventDefault()},b}};var C,D,E={wrap:"box-dialog",title:"boxdialog-title",close:"boxdialog-close",content:"boxdialog-content",btns:"boxdialog-btns",icon:"boxdialog-icon",shade:"box-dialog-shade",topActive:"box-dialog-active",btnActive:"boxbtn-active",iframe:"boxdialog-iframe"};return C=function(a){return z(a)?m=a:void 0},D={title:"消息",content:"欢迎使用boxDialog!",ok:!0,cancel:!0,okText:"确定",cancelText:"取消",size:["auto","auto"],padding:"20px",icon:null,time:null,shade:{background:"#000",opacity:.8,duration:200},fixed:!0,zIndex:2010,drag:!1,esc:!0,position:null,closeBtn:!0,varBtns:null,className:null,initCallback:null,okCallback:null,cancelCallback:null,closeCallback:null},o.on("keydown",function(a){var b,a=a||n.event,e=!0,f=t.length;f&&e&&27==a.keyCode&&(b=c(),d(b),e=!1)}),k.boxDialog=k.fn.boxDialog=function(a){i(a)},j={open:i,config:C,close:d,closeAll:e,msg:f,alert:g,loading:h},window.boxDialog=j,j});